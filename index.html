<!DOCTYPE HTML">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>New Web Project</title>
	</head>
	<body>
		<h1>New Web Project Page</h1> 
		<video id="videoInput" width="320" height="240"></video>
		<canvas id="canvasOutput"></canvas>
		<button onclick="captureImage();">Capture image</button>
		<button id = "buttonStartPause" onclick="pause();">Pause</button>

		<script src="https://webrtc.github.io/adapter/adapter-5.0.4.js" type="text/javascript"></script>
		<script src="js/utils.js" type="text/javascript"></script>
		<script async src="js/opencv.js" onload="onOpenCvReady();" type="text/javascript"></script>
		<script type="text/javascript">
			
			
			function pause(){
				video = document.getElementById('videoInput');
				buttonStartPause = document.getElementById("buttonStartPause");
                if (buttonStartPause.innerHTML == "Start")
                {
                    buttonStartPause.innerHTML = "Pause";
					video.play();
                }
                else {
                    buttonStartPause.innerHTML = "Start";
					video.pause();
                }
				
				
			}
		
			function captureImage() {
				video = document.getElementById('videoInput');
				src = new cv.Mat(video.height, video.width, cv.CV_8UC4);
			 	dst = new cv.Mat(video.height, video.width, cv.CV_8UC1);
				cap = new cv.VideoCapture(video);
				cap.read(src);
				cv.cvtColor(src, dst, cv.COLOR_RGBA2GRAY);
				cv.imshow('canvasOutput', dst);
			};

			function onOpenCvReady() {
				startStreamVideo()
			}

			function startStreamVideo() {
				video = document.getElementById("videoInput");
				// video is the id of video tag
				navigator.mediaDevices.getUserMedia({
					video : true,
					audio : false
				}).then(function(stream) {
					video.srcObject = stream;
					video.play();
				}).catch(function(err) {
					console.log("An error occurred! " + err);
				});
			}
		</script>
	</body>
</html>
